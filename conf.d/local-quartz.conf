server {
    listen 80;
    server_name localhost;

    # Document root for all requests that finally land on /notes
    root /home/alexa/git/notnotes/public;
    index index.html;
    error_page 404 /404.html;

    # 1. Anything that is NOT /notes gets 301-moved to /notes
    location = / {
        return 301 /notes/;
    }

    # 2. Anything that starts with /notes is handled here
    location /notes/ {
        # chop the "/notes" prefix so that
        # /notes/foo  â†’  /home/alexa/git/notnotes/public/foo
        alias /home/alexa/git/notnotes/public/;
        
        # Handle directory requests by adding trailing slash with /notes prefix
        location ~ ^/notes/(.*)(?<!/)$ {
            if (-d /home/alexa/git/notnotes/public/$1) {
                return 301 /notes/$1/;
            }
        }
        
        try_files $uri $uri.html $uri/ =404;
    }
    
    # Catch any other paths and redirect to /notes
    location / {
        return 301 /notes$uri;
    }
}   